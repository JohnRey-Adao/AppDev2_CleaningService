<div class="dashboard-container">
  <!-- Header Section -->
  <div class="row mb-5">
    <div class="col-12">
      <div class="d-flex align-items-center justify-content-between">
        <div>
          <h1 class="display-6 fw-bold text-primary mb-2">
            <i class="fas fa-broom me-3"></i>Cleaner Dashboard
          </h1>
          <p class="text-secondary mb-0">Manage your cleaning jobs and earnings</p>
        </div>
        <div class="text-end">
          <div class="badge bg-success fs-6 px-3 py-2">
            <i class="fas fa-broom me-2"></i>Professional Cleaner
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Navigation Tabs -->
  <div class="row mb-4">
    <div class="col-12">
      <ul class="nav nav-tabs">
        <li class="nav-item">
          <button class="nav-link" [class.active]="activeTab==='overview'" (click)="setActiveTab('overview')">
            <i class="fas fa-chart-line me-2"></i>Overview
          </button>
        </li>
        <li class="nav-item">
          <button class="nav-link" [class.active]="activeTab==='jobs'" (click)="setActiveTab('jobs')">
            <i class="fas fa-list me-2"></i>My Jobs
          </button>
        </li>
        <li class="nav-item">
          <button class="nav-link" [class.active]="activeTab==='profile'" (click)="setActiveTab('profile')">
            <i class="fas fa-user me-2"></i>Profile
          </button>
        </li>
      </ul>
    </div>
  </div>

  <div class="tab-content">
    <!-- Overview Tab -->
    <div class="tab-pane" [class.active]="activeTab==='overview'">
      <div class="row g-4 mb-5">
        <div class="col-lg-3 col-md-6" *ngFor="let card of [
          {icon:'calendar-check', title:'Total Jobs', value: totalJobs, cls:'text-primary', bg:'bg-primary'},
          {icon:'clock', title:'Pending', value: pendingJobs, cls:'text-warning', bg:'bg-warning'},
          {icon:'check-circle', title:'Completed', value: completedJobs, cls:'text-success', bg:'bg-success'},
          {icon:'coins', title:'Earnings', value: (totalEarnings | currency), cls:'text-info', bg:'bg-info'}
        ]; let i = index">
          <div class="card dashboard-card h-100">
            <div class="card-body text-center p-4">
              <div class="mb-3">
                <div class="rounded-circle d-inline-flex align-items-center justify-content-center {{card.bg}} text-white" 
                     style="width: 60px; height: 60px;">
                  <i class="fas fa-{{card.icon}} fa-lg"></i>
                </div>
              </div>
              <h6 class="card-title fw-bold text-secondary mb-2">{{ card.title }}</h6>
              <h3 class="fw-bold {{card.cls}} mb-0">{{ card.value }}</h3>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6">
          <div class="card">
            <div class="card-header">
              <h5><i class="fas fa-chart-line me-2"></i>Quick Stats</h5>
            </div>
            <div class="card-body">
              <p><strong>Average Rating:</strong> 4.8/5</p>
              <p><strong>Jobs This Month:</strong> {{ jobsThisMonth }}</p>
              <p><strong>Earnings This Month:</strong> {{ earningsThisMonth | currency }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Jobs Tab -->
    <div class="tab-pane" [class.active]="activeTab==='jobs'">
      <div class="row">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h5><i class="fas fa-list me-2"></i>My Jobs</h5>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-hover">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Customer</th>
                      <th>Duration</th>
                      <th>Amount</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let booking of bookings">
                      <td>{{ formatDate(booking.bookingDate) }}</td>
                      <td>{{ booking.customer.firstName }} {{ booking.customer.lastName }}</td>
                      <td>{{ booking.durationHours }}h</td>
                      <td>{{ booking.totalAmount | currency }}</td>
                      <td>
                        <span class="badge" [ngClass]="getStatusClass(booking.status)">
                          {{ booking.status }}
                        </span>
                      </td>
                      <td>
                        <button class="btn btn-sm btn-success me-1" 
                                *ngIf="booking.status === 'PENDING'"
                                (click)="confirmBooking(booking.id)">
                          Confirm
                        </button>
                        <button class="btn btn-sm btn-primary me-1" 
                                *ngIf="booking.status === 'CONFIRMED'"
                                (click)="startBooking(booking.id)">
                          Start
                        </button>
                        <button class="btn btn-sm btn-success me-1" 
                                *ngIf="booking.status === 'IN_PROGRESS'"
                                (click)="completeBooking(booking.id)">
                          Complete
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Profile Tab -->
    <div class="tab-pane" [class.active]="activeTab==='profile'">
      <div class="row">
        <div class="col-md-6">
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5><i class="fas fa-user me-2"></i>My Profile</h5>
              <img [src]="cleaner ? getCleanerImage(cleaner) : 'assets/images/default-cleaner.svg'" [alt]="(cleaner?.firstName || 'Cleaner') + ' ' + (cleaner?.lastName || '')" class="rounded-circle" style="width:48px;height:48px;object-fit:cover;">
            </div>
            <div class="card-body">
              <p><strong>Name:</strong> {{ cleaner?.firstName }} {{ cleaner?.lastName }}</p>
              <p><strong>Email:</strong> {{ cleaner?.email }}</p>
              <p><strong>Phone:</strong> {{ cleaner?.phoneNumber || 'Not provided' }}</p>
              <p><strong>Address:</strong> {{ cleaner?.address }}</p>
              <p><strong>Hourly Rate:</strong> {{ cleaner?.hourlyRate | currency }}/hr</p>
              <p><strong>Bio:</strong> {{ cleaner?.bio || 'No bio provided' }}</p>
              <p><strong>Status:</strong> 
                <span class="badge" [ngClass]="getStatusClass(cleaner?.cleanerStatus || '')">
                  {{ cleaner?.cleanerStatus }}
                </span>
              </p>
              <div class="d-flex gap-2">
                <button class="btn btn-outline-primary btn-sm me-2" (click)="editingProfile = true">Edit Profile</button>
                <button class="btn btn-outline-secondary btn-sm" (click)="toggleStatus()">
                  {{ cleaner?.cleanerStatus === 'AVAILABLE' ? 'Go Offline' : 'Go Online' }}
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6" *ngIf="editingProfile && cleaner">
          <div class="card">
            <div class="card-header">
              <h5><i class="fas fa-edit me-2"></i>Edit Profile</h5>
            </div>
            <div class="card-body">
              <form (ngSubmit)="saveCleanerProfile()">
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label">First Name</label>
                    <input class="form-control" [(ngModel)]="cleaner!.firstName" name="firstName">
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Last Name</label>
                    <input class="form-control" [(ngModel)]="cleaner!.lastName" name="lastName">
                  </div>
                </div>
                <div class="mb-3">
                  <label class="form-label">Phone</label>
                  <input class="form-control" [(ngModel)]="cleaner!.phoneNumber" name="phone">
                </div>
                <div class="mb-3">
                  <label class="form-label">Address</label>
                  <input class="form-control" [(ngModel)]="cleaner!.address" name="address">
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label">City</label>
                    <input class="form-control" [(ngModel)]="cleaner!.city" name="city">
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Region</label>
                    <input class="form-control" [(ngModel)]="cleaner!.region" name="region">
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Postal Code</label>
                    <input class="form-control" [(ngModel)]="cleaner!.postalCode" name="postalCode">
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Country</label>
                    <input class="form-control" [(ngModel)]="cleaner!.country" name="country">
                  </div>
                </div>
                <div class="mb-3">
                  <label class="form-label">Bio</label>
                  <textarea class="form-control" [(ngModel)]="cleaner!.bio" name="bio" rows="3" placeholder="Tell customers about your cleaning experience..."></textarea>
                </div>
                <div class="mb-3">
                  <label class="form-label">Profile Picture</label>
                  <input type="file" class="form-control" (change)="onPhotoSelected($event)" accept="image/*">
                </div>
                <div class="d-flex gap-2">
                  <button class="btn btn-primary" type="submit">Save</button>
                  <button class="btn btn-secondary" type="button" (click)="editingProfile = false">Cancel</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
